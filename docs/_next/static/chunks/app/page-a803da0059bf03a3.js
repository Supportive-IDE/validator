(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2103:function(e,t,a){Promise.resolve().then(a.bind(a,8836))},8836:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var s=a(7437),n=a(2265),r=a(345),i=a.n(r);class l{constructor(e,t,a){this.affectedText="",this.line=-1,this.fileName="",this.affectedText=e,this.line=t,this.fileName=a}}let o=e=>new DOMParser().parseFromString(e,"text/html"),h=(e,t,a,s,n)=>new Promise((r,i)=>{let h=new FileReader;h.onerror=t=>{n.push(e.webkitRelativePath),i("Unable to read ".concat(e.webkitRelativePath))},h.onloadend=()=>{console.log("Read",h.result),"string"==typeof h.result?t.set(e.webkitRelativePath,o(h.result)):t.set(e.webkitRelativePath,new Document),fetch("https://validator.w3.org/nu/?out=json",{method:"POST",headers:{"Content-Type":"text/html; charset=UTF-8"},body:e}).then(e=>e.json()).then(t=>{if(t.hasOwnProperty("messages"))for(let r of t.messages){var i,o;let t=new l(r.extract,r.lastLine,e.name);"error"===r.type?(a.has(r.message)||a.set(r.message,[]),null===(i=a.get(r.message))||void 0===i||i.push(t)):"info"===r.type?(s.has(r.message)||s.set(r.message,[]),null===(o=s.get(r.message))||void 0===o||o.push(t)):n.push(e.webkitRelativePath)}r("Validated ".concat(e.webkitRelativePath))}).catch(t=>{i("Error parsing ".concat(e.webkitRelativePath,": ").concat(t))})},h.readAsText(e)}),c=(e,t,a,s)=>new Promise((a,n)=>{let r=new FileReader;r.onerror=t=>{s.push(e.webkitRelativePath),n("Unable to read ".concat(e.webkitRelativePath))},r.onloadend=()=>{console.log("Read",r.result),fetch("".concat("https://jigsaw.w3.org/css-validator/validator","?text=").concat(r.result)).then(e=>e.text()).then(s=>{let n=new DOMParser().parseFromString(s,"text/html");for(let a of Array.from(n.getElementsByClassName("error"))){var r;let s=Array.from(a.getElementsByTagName("td")),n=-1,i="",o="";for(let e of s)switch(e.className){case"linenumber":n=parseInt(e.innerText);break;case"codeContext":i=e.innerHTML;break;case"parse-error":o=e.innerHTML}let h=new l(i,n,e.webkitRelativePath);t.has(o)||t.set(o,[]),null===(r=t.get(o))||void 0===r||r.push(h)}console.log(n),a("Read ".concat(e.webkitRelativePath))}).catch(t=>{s.push(e.webkitRelativePath),console.log(t),n("Error validating ".concat(e.webkitRelativePath))})},r.readAsText(e)}),d=e=>{for(let t of e.keys())if(t.toLowerCase().endsWith("/index.html"))return(0,s.jsx)("li",{children:"PASS: project has an index.html"});return(0,s.jsx)("li",{children:"FAIL: project does not have an index.html"})};function m(){let[e,t]=(0,n.useState)("No submission selected"),[a,r]=(0,n.useState)(new Map),[l,o]=(0,n.useState)(new Set),[m,f]=(0,n.useState)(new Map),[u,x]=(0,n.useState)(new Map),[g,p]=(0,n.useState)(new Map),[w,j]=(0,n.useState)(new Map),[b,v]=(0,n.useState)([]);return(0,s.jsxs)("main",{className:i().main,children:[(0,s.jsx)("h1",{children:e}),(0,s.jsx)("label",{htmlFor:"file-upload",children:"Choose a submission (should be the folder the contains the student's HTML and CSS)"}),(0,s.jsx)("input",{id:"file-upload",type:"file",name:"file upload",onChange:e=>{if(e.target.files&&e.target.files.length>0){let a=e.target.files[0].webkitRelativePath.substring(0,e.target.files[0].webkitRelativePath.indexOf("/")),s=new Map,n=new Set,i=new Map,l=new Map,d=[],m=new Map,u=new Map;for(let t of Array.from(e.target.files))t.name.toLowerCase().endsWith(".css")&&n.add(t.webkitRelativePath);let g=[];for(let t of Array.from(e.target.files))t.name.toLowerCase().endsWith(".html")?g.push(h(t,s,i,l,d)):t.name.toLowerCase().endsWith(".css")&&g.push(c(t,m,u,d));Promise.all(g).then(e=>{for(let t of e)console.log(t);t(a),r(s),o(n),f(i),x(l),j(m),v(d)})}},directory:"",webkitdirectory:"",mozdirectory:""}),b.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{children:"Validator parsing errors:"}),(0,s.jsx)("ul",{children:b.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]}),a.size>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{children:"HTML validation results:"}),(0,s.jsxs)("p",{children:["HTML files checked: ",Array.from(a.keys()).join(", ")]}),0===m.size?(0,s.jsx)("p",{children:"No HTML validation errors found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{children:"Errors"}),(0,s.jsx)("ul",{children:Array.from(m.entries()).map((e,t)=>(0,s.jsxs)("li",{children:[e[0],(0,s.jsx)("ul",{children:e[1].map((e,t)=>(0,s.jsxs)("li",{children:[e.fileName,", line number ",e.line,": ",(0,s.jsx)("code",{children:e.affectedText})]},t))})]},t))})]}),0===u.size?(0,s.jsx)("p",{children:"No HTML validation warnings found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{children:"Warnings"}),(0,s.jsx)("ul",{children:Array.from(u.entries()).map((e,t)=>(0,s.jsxs)("li",{children:[e[0],(0,s.jsx)("ul",{children:e[1].map((e,t)=>(0,s.jsxs)("li",{children:[e.fileName,", line number ",e.line,": ",(0,s.jsx)("code",{children:e.affectedText})]},t))})]},t))})]}),(0,s.jsx)("h3",{children:"Custom checks"}),d(a),(()=>{let e=0,t=0,n=0;for(let[s,r]of a){let a=Array.from(document.getElementsByTagName("img"));for(let s of(e+=a.length,a)){let e=s.getAttribute("alt");null!==e&&(e.length>0?t++:n++)}}return t===e?(0,s.jsx)("li",{children:"PASS: All images have alt attributes that contain text - check they are also meaningful!"}):(0,s.jsxs)("li",{children:["FAIL: ","".concat(n," of ").concat(e," images have empty alt attributes. ").concat(e-n-t," of ").concat(e," images have no alt attribute.")]})})()]}),l.size>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{children:"CSS validation results:"}),(0,s.jsxs)("p",{children:["CSS files checked: ",Array.from(l).join(", ")]}),0===w.size?(0,s.jsx)("p",{children:"No CSS validation errors found."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h3",{children:"Errors"}),(0,s.jsx)("ul",{children:Array.from(w.entries()).map((e,t)=>(0,s.jsxs)("li",{children:[e[0],(0,s.jsx)("ul",{children:e[1].map((e,t)=>(0,s.jsxs)("li",{children:[e.fileName,", line number ",e.line,": ",e.affectedText]},t))})]},t))})]})]})]})}},345:function(e){e.exports={main:"page_main__GlU4n",code:"page_code__9lUUd"}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=2103)}),_N_E=e.O()}]);