(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2663:function(e,t,s){Promise.resolve().then(s.bind(s,8397))},8397:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var a=s(7437),i=s(2265),l=s(2293),n=s.n(l);let r=[{regexFail:/[^!=]((!|=)=)[^=]/g,regexPass:/[^!=](!|=)==[^=]/g,description:"Equality / inequality comparisons use the strict operators: instead of == use === and instead of != use !==."},{regexFail:/\bvar\b/g,regexPass:/\b(let|const)\b/g,description:"Variables are declared using let or const and not the outdated var keyword."}];class o{constructor(e,t,s){this.affectedText="",this.line=-1,this.fileName="",this.affectedText=e,this.line=t,this.fileName=s}}class c{evaluation(){return 0===this.pass&&0===this.fail?"N/A":0===this.fail&&this.pass>0?"all ES6 syntax":this.fail>0&&0===this.fail?"only outdated syntax":"Mixed: ".concat(this.pass," ES6; ").concat(this.fail," outdated. Use judgement!")}constructor(){this.pass=0,this.fail=0}}let h=e=>new DOMParser().parseFromString(e,"text/html"),d=(e,t,s,a)=>new Promise((i,l)=>{let n=new FileReader;n.onerror=t=>{a.push(e.webkitRelativePath),l("Unable to read ".concat(e.webkitRelativePath))},n.onloadend=a=>{if("string"==typeof n.result){for(let a of(t.set(e.webkitRelativePath,n.result),r)){var o,h;for(let t of(s.has(a.description)||s.set(a.description,new c),n.result.matchAll(a.regexPass))){let t=s.get(a.description);t&&(console.log("PASS",a.description,e.webkitRelativePath),t.pass++)}for(let t of n.result.matchAll(a.regexFail)){let t=s.get(a.description);t&&(console.log("FAIL",a.description,e.webkitRelativePath),t.fail++)}console.log(a.description,"passed",null===(o=s.get(a.description))||void 0===o?void 0:o.pass,"failed",null===(h=s.get(a.description))||void 0===h?void 0:h.fail)}i("Validated ".concat(e.webkitRelativePath))}else console.log("Oops file is a",typeof n.result),l("Unable to read ".concat(e.webkitRelativePath))},n.readAsText(e)}),u=(e,t,s,a,i)=>new Promise((l,n)=>{let r=new FileReader;r.onerror=t=>{i.push(e.webkitRelativePath),n("Unable to read ".concat(e.webkitRelativePath))},r.onloadend=()=>{"string"==typeof r.result?t.set(e.webkitRelativePath,h(r.result)):t.set(e.webkitRelativePath,new Document),fetch("https://validator.w3.org/nu/?out=json",{method:"POST",headers:{"Content-Type":"text/html; charset=UTF-8"},body:e}).then(e=>e.json()).then(t=>{if(t.hasOwnProperty("messages"))for(let l of t.messages){var n,r;let t=new o(l.extract,l.lastLine,e.name);"error"===l.type?(s.has(l.message)||s.set(l.message,[]),null===(n=s.get(l.message))||void 0===n||n.push(t)):"info"===l.type?(a.has(l.message)||a.set(l.message,[]),null===(r=a.get(l.message))||void 0===r||r.push(t)):i.push(e.webkitRelativePath)}l("Validated ".concat(e.webkitRelativePath))}).catch(t=>{n("Error parsing ".concat(e.webkitRelativePath,": ").concat(t))})},r.readAsText(e)}),f=e=>{for(let t of e.keys())if(t.toLowerCase().endsWith("/index.html"))return(0,a.jsx)("li",{children:"PASS: project has an index.html"});return(0,a.jsx)("li",{children:"FAIL: project does not have an index.html"})};function p(){let[e,t]=(0,i.useState)("No submission selected"),[s,l]=(0,i.useState)(new Map),[r,o]=(0,i.useState)(new Map),[c,h]=(0,i.useState)(new Map),[p,m]=(0,i.useState)([]),[g,x]=(0,i.useState)(new Map);return(0,a.jsxs)("main",{className:n().main,children:[(0,a.jsx)("h1",{children:e}),(0,a.jsx)("label",{htmlFor:"file-upload",children:"Choose a submission (should be the folder that contains the student's HTML and JS)"}),(0,a.jsx)("input",{id:"file-upload",type:"file",name:"file upload",onChange:e=>{if(e.target.files&&e.target.files.length>0){let s=e.target.files[0].webkitRelativePath.substring(0,e.target.files[0].webkitRelativePath.indexOf("/")),a=new Map,i=new Map,n=new Map,r=new Map,c=new Map,f=[],p=[];for(let t of Array.from(e.target.files))t.name.toLowerCase().endsWith(".html")&&p.push(u(t,a,n,r,f)),t.name.toLowerCase().endsWith(".js")&&p.push(d(t,i,c,f));Promise.all(p).then(e=>{for(let t of e)console.log(t);t(s),l(a),x(i),o(n),m(f),h(c)})}},directory:"",webkitdirectory:"",mozdirectory:""}),p.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{children:"Validator parsing errors:"}),(0,a.jsx)("ul",{children:p.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]}),s.size>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{children:"HTML validation results:"}),(0,a.jsxs)("p",{children:["HTML files checked: ",Array.from(s.keys()).join(", ")]}),0===r.size?(0,a.jsx)("p",{children:"No HTML validation errors found."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{children:"Errors"}),(0,a.jsx)("ul",{children:Array.from(r.entries()).map((e,t)=>(0,a.jsxs)("li",{children:[e[0],(0,a.jsx)("ul",{children:e[1].map((e,t)=>(0,a.jsxs)("li",{children:[e.fileName,", line number ",e.line,": ",(0,a.jsx)("code",{children:e.affectedText})]},t))})]},t))})]}),(0,a.jsx)("h3",{children:"Custom checks"}),f(s),(()=>{let e=0,t=0,i=0;for(let[a,l]of s){let s=Array.from(document.getElementsByTagName("img"));for(let a of(e+=s.length,s)){let e=a.getAttribute("alt");null!==e&&(e.length>0?t++:i++)}}return t===e?(0,a.jsx)("li",{children:"PASS: All images have alt attributes that contain text - check they are also meaningful!"}):(0,a.jsxs)("li",{children:["FAIL: ","".concat(i," of ").concat(e," images have empty alt attributes. ").concat(e-i-t," of ").concat(e," images have no alt attribute.")]})})()]}),g.size>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{children:"JS ES6 syntax check results:"}),(0,a.jsxs)("p",{children:["JS files checked: ",Array.from(g.keys()).join(", ")]}),0===c.size?(0,a.jsx)("p",{children:"No JS checks performed."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{children:"Syntax check results"}),(0,a.jsx)("ul",{children:Array.from(c.entries()).map((e,t)=>(0,a.jsxs)("li",{children:[e[0],(0,a.jsx)("ul",{children:(0,a.jsx)("li",{children:e[1].evaluation()})})]},t))})]})]})]})}},2293:function(e){e.exports={main:"page_main__GlU4n",code:"page_code__9lUUd"}}},function(e){e.O(0,[591,971,117,744],function(){return e(e.s=2663)}),_N_E=e.O()}]);