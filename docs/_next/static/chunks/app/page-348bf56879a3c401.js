(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2103:function(e,t,s){Promise.resolve().then(s.bind(s,8836))},8836:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var n=s(7437),r=s(2265),a=s(345),i=s.n(a);class l{constructor(e,t,s){this.affectedText="",this.line=-1,this.fileName="",this.affectedText=e,this.line=t,this.fileName=s}}let o=(e,t,s,n)=>fetch("https://validator.w3.org/nu/?out=json",{method:"POST",headers:{"Content-Type":"text/html; charset=UTF-8"},body:e}).then(e=>e.json()).then(r=>{if(r.hasOwnProperty("messages"))for(let o of r.messages){var a,i;let r=new l(o.extract,o.lastLine,e.name);"error"===o.type?(t.has(o.message)||t.set(o.message,[]),null===(a=t.get(o.message))||void 0===a||a.push(r)):"info"===o.type?(s.has(o.message)||s.set(o.message,[]),null===(i=s.get(o.message))||void 0===i||i.push(r)):n.push(e.webkitRelativePath)}}).catch(t=>{console.log("Error parsing ".concat(e.webkitRelativePath,": ").concat(t))}),h=(e,t,s,n)=>new Promise((s,r)=>{let a=new FileReader;a.onerror=t=>{n.push(e.webkitRelativePath),r("Unable to read ".concat(e.webkitRelativePath))},a.onloadend=()=>{console.log("Read",a.result),fetch("".concat("https://jigsaw.w3.org/css-validator/validator","?text=").concat(a.result)).then(e=>e.text()).then(n=>{let r=new DOMParser().parseFromString(n,"text/html");for(let s of Array.from(r.getElementsByClassName("error"))){var a;let n=Array.from(s.getElementsByTagName("td")),r=-1,i="",o="";for(let e of n)switch(e.className){case"linenumber":r=parseInt(e.innerText);break;case"codeContext":i=e.innerHTML;break;case"parse-error":o=e.innerHTML}let h=new l(i,r,e.webkitRelativePath);t.has(o)||t.set(o,[]),null===(a=t.get(o))||void 0===a||a.push(h)}console.log(r),s("Read ".concat(e.webkitRelativePath))}).catch(t=>{n.push(e.webkitRelativePath),console.log(t),r("Error validating ".concat(e.webkitRelativePath))})},a.readAsText(e)});function c(){let[e,t]=(0,r.useState)("No submission selected"),[s,a]=(0,r.useState)(new Map),[l,c]=(0,r.useState)(new Map),[d,f]=(0,r.useState)(new Map),[m,u]=(0,r.useState)(new Map),[p,x]=(0,r.useState)(new Map),[g,j]=(0,r.useState)(new Map),[w,b]=(0,r.useState)([]);return(0,n.jsxs)("main",{className:i().main,children:[(0,n.jsx)("h1",{children:e}),(0,n.jsx)("label",{htmlFor:"file-upload",children:"Choose a submission (should be the folder the contains the student's HTML and CSS)"}),(0,n.jsx)("input",{id:"file-upload",type:"file",name:"file upload",onChange:e=>{if(e.target.files&&e.target.files.length>0){let s=e.target.files[0].webkitRelativePath.substring(0,e.target.files[0].webkitRelativePath.indexOf("/")),n=new Map,r=new Map,i=new Map,l=new Map,d=[],m=new Map,p=new Map;for(let t of Array.from(e.target.files))t.name.toLowerCase().endsWith(".html")?n.set(t.name,t):t.name.toLowerCase().endsWith(".css")&&r.set(t.name,t);let g=[];for(let t of Array.from(e.target.files))t.name.toLowerCase().endsWith(".html")?g.push(o(t,i,l,d)):t.name.toLowerCase().endsWith(".css")&&g.push(h(t,m,p,d));Promise.all(g).then(e=>{for(let t of e)console.log(t);t(s),a(n),c(r),f(i),u(l),x(m),b(d)})}},directory:"",webkitdirectory:"",mozdirectory:""}),w.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h2",{children:"Validator parsing errors:"}),(0,n.jsx)("ul",{children:w.map((e,t)=>(0,n.jsx)("li",{children:e},t))})]}),s.size>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["HTML files found: ",Array.from(s.keys()).join(", ")]}),(0,n.jsx)("h2",{children:"HTML validation results:"}),0===d.size?(0,n.jsx)("p",{children:"No HTML validation errors found."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{children:"Errors"}),(0,n.jsx)("ul",{children:Array.from(d.entries()).map((e,t)=>(0,n.jsxs)("li",{children:[e[0],(0,n.jsx)("ul",{children:e[1].map((e,t)=>(0,n.jsxs)("li",{children:[e.fileName,", line number ",e.line,": ",(0,n.jsx)("code",{children:e.affectedText})]},t))})]},t))})]}),0===m.size?(0,n.jsx)("p",{children:"No HTML validation warnings found."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{children:"Warnings"}),(0,n.jsx)("ul",{children:Array.from(m.entries()).map((e,t)=>(0,n.jsxs)("li",{children:[e[0],(0,n.jsx)("ul",{children:e[1].map((e,t)=>(0,n.jsxs)("li",{children:[e.fileName,", line number ",e.line,": ",(0,n.jsx)("code",{children:e.affectedText})]},t))})]},t))})]})]}),l.size>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["CSS files found: ",Array.from(l.keys()).join(", ")]}),(0,n.jsx)("h2",{children:"CSS validation results:"}),0===p.size?(0,n.jsx)("p",{children:"No CSS validation errors found."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h3",{children:"Errors"}),(0,n.jsx)("ul",{children:Array.from(p.entries()).map((e,t)=>(0,n.jsxs)("li",{children:[e[0],(0,n.jsx)("ul",{children:e[1].map((e,t)=>(0,n.jsxs)("li",{children:[e.fileName,", line number ",e.line,": ",(0,n.jsx)("code",{children:e.affectedText})]},t))})]},t))})]})]})]})}},345:function(e){e.exports={main:"page_main__GlU4n",code:"page_code__9lUUd"}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=2103)}),_N_E=e.O()}]);